\documentclass[zavrsnirad]{fer}
% Dodaj opciju upload za generiranje konačne verzije koja se učitava na FERWeb
% Add the option upload to generate the final version which is uploaded to FERWeb


\usepackage{blindtext}
\usepackage{tabularray}
\usepackage{xltabular} % for xltabular environment
\usepackage{amsmath} % for mathematical symbols and formatting
\usepackage{graphicx} % Include the graphicx package
% \usepackage{enumitem} % Include the enumitem package

% \setlist[itemize]{itemsep=0.01em, topsep=0.01em} % Adjust the spacing as needed


%--- PODACI O RADU / THESIS INFORMATION ----------------------------------------

% Naslov na engleskom jeziku / Title in English
\title{Intelligent player for Prisoner's Dilemma}

% Naslov na hrvatskom jeziku / Title in Croatian
\naslov{Inteligentni igrač za Zatvorenikovu dilemu}

% Broj rada / Thesis number
\brojrada{1678}

% Autor / Author
\author{Petar Belošević}

% Mentor 
\mentor{Prof. Marko Čupić}

% Datum rada na engleskom jeziku / Date in English
\date{June, 2024}

% Datum rada na hrvatskom jeziku / Date in Croatian
\datum{lipanj, 2024.}

%-------------------------------------------------------------------------------


\begin{document}


% Naslovnica se automatski generira / Titlepage is automatically generated
\maketitle


%--- ZADATAK / THESIS ASSIGNMENT -----------------------------------------------

% Zadatak se ubacuje iz vanjske datoteke / Thesis assignment is included from external file
% Upiši ime PDF datoteke preuzete s FERWeb-a / Enter the filename of the PDF downloaded from FERWeb
\zadatak{Extra/hr-0036538383-73.pdf}


%--- ZAHVALE / ACKNOWLEDGMENT --------------------------------------------------

\begin{zahvale}
  % Ovdje upišite zahvale / Write in the acknowledgment
\end{zahvale}


% Odovud započinje numeriranje stranica / Page numbering starts from here
\mainmatter


% Sadržaj se automatski generira / Table of contents is automatically generated
\tableofcontents


%--- UVOD / INTRODUCTION -------------------------------------------------------
\chapter{Uvod}
\label{pog:uvod}

	Zatvorenikova dilema jedan je od najpoznatijih problema iz područja teorije igara. Dilema proučava interakciju između dvaju pojedinaca kroz igru suradnje i izdaje. Zatvorenikova dilema se može pronaći u korijenu mnogih interakcija koje se pojavljuju u društvu, ali i u životinjskom svijetu. Glavno pitanje je kako ta interakcija utječe na dobrobit oba igrača. Paradoks u Zatvorenikove dileme je činjenica da racionalno razmišljanje navodi svakog pojedinca da odabire opciju koja ne odgovara niti jednom od igrača \cite{PrisDilemmaHrEnc}.
	
	U stvarnom životu su takve interakcije često ponavljajuće prirode. Tada je potrebno imati na umu da će druga strana vjerojatno imati iskustvo prošlih interakcija što može utjecati na njihovu odluku u novoj interakciji. Stoga je interesantno razmatranje malo složenijeg problema ponavljajuće Zatvorenikove dileme. Zanimljivo je da se u ponavljajućem problemu mijenja pristup optimalnoj strategiji u odnosu na jednu Zatvorenikovu dilemu.
	
	U korijenu Zatvorenikove dileme je napetost između individualnog racionalizma (u pogledu da je objema stranama smisleno biti sebičan) i grupnog racionalizma (objema stranama je isplativija suradnja nego obostrana izdaja) \cite{1980Axelrod1}.
	
	Mnogo je radova na pisano na temu optimalnog načina igranja Zatvorenikove dileme. Tako je Robert Axelrod iz Sveučilišta u Michiganu održao dva turnira u kojima su sudionici predavali svoje strategije za igranje igre u obliku računalnih programa \cite{1980Axelrod1} \cite{1980Axelrod2}. Analizom turnira došlo se zanimljivih zaključaka. Axelrod je proučavanjem strategija i njihovih rezultata izlučio nekoliko karakteristika koje imale tendenciju davati bolje rezultate. Te karakteristike su ljubaznost, opraštanje i provokabilnost \cite{1980Axelrod2}.
	
	Glavni cilj ovog rada je napraviti model inteligentnog igrača koji će naučiti kvalitetno igrati ponavljajuću Zatvorenikovu dilemu. Kod dobivenog modela će se proučiti njegovo ponašanje te će biti zanimljivo vidjeti je li dobiveni inteligentni igrač razvio karakteristike koje su se pokazale poželjnima u Axelrodovim turnirima.
	
%	Glavni cilj ovog rada je napraviti model inteligentnog igrača koji će naučiti igrati ponavljajuću Zatvorenikovu dilemu. Cilj ovoga je proučiti kakvo će ponašanje razviti inteligentni igrač i kako će igrati protiv nekih drugih poznatih strategija. Također će biti zanimljivo analizirati ponašanje inteligentnog igrača i vidjeti je li razvio karakteristike koje su se pokazale poželjnima u Axelrodovim turnirima.

%-------------------------------------------------------------------------------
\chapter{Zatvorenikova dilema}
\label{pog:ZatvorenikovaDilema}

	Zatvorenikova dilema je poznati problem iz područja teorije igara koji proučava odnose između pojedinaca. Radi se o igri s dva igrača koji imaju na izboru dva poteza: suradnja s drugim igračem ili izdaja drugog igrača. S obzirom na odabir oba igrača, svakom od njih se daje određena kazna ili nagrada. 
	
	Zatvorenikova dilema je dobila naziv po ilustrativnom opisu Alberta Tuckera \cite{TeorijaIgaraIPravo}. Dilema je opisana u kontekstu odvojenog ispitivanja dvojice osumnjičenih kriminalaca. Svaki od osumnjičenih može priznati krivnju (ekvivalentno izdaji) ili šutjeti (ekvivalentno suradnji). Sukladno njihovim potezima dodjeljuju im se zatvorske kazne. Ako i jedan i drugi osumnjičenik šute, dobivanju male zatvorske kazne zbog nedostatka dokaza. Ako i jedan i drugi priznaju krivnju, svatko od njih dobiva veće zatvorske kazne jer su priznali krivnju. Ako pak jedan od njih prizna krivnju a drugi šuti, ovaj koji je priznao krivnju biva oslobođen optužbi kao nagrada za suradnju s pravosudnim organima, a drugi dobiva još veću zatvorsku kaznu zbog toga što je odugovlačio postupak odbijanjem priznavanja krivice \cite{TeorijaIgaraIPravo}.
	
	Dilema se naravno može staviti i opisati kroz razne druge slikovite kontekste. No, u ovom radu će se radi jednostavnosti na dilemu gledati samo kao igru u kojoj igrači skupljaju bodove.

	Generalna pravila za "bodovanje" je da suradnja oba igrača i obostrana izdaja daju simetričnu podjelu bodova, uz to da suradnja daje veći broj bodova. U slučaju da jedan igrač surađuje dok ga drugi izdaje dolazi do nesimetrične podjele bodova. Igrač koje je izdan mora dobiti manje bodove nego bi dobio obostranom izdajom. Igrač koji ga je izdao tim potezom mora dobiti više nego bi dobio suradnjom oba igrača. Tipična raspodjela bodova \cite{1980Axelrod1} koja će se koristiti i u ovom radu dana je u tablici \ref{Payoffs}.
	 
	Važno je primijetiti da je Zatvorenikova dilema igra s promjenjivim ishodom \cite{PrisDilemmaHrEnc}. To znači da dobitak jednog igrača nije nužno gubitak drugog igrača i gubitak jednog igrača ne mora nužno biti dobitak drugog igrača \cite{igraHrEnc}. Drugim riječima, mogući su ishodi u kojima oba igrača profitiraju ili oba igrača gube. Upravo ova karakteristika omogućuje suradnji da bude poželjan pristup igranju. 
	
	\begin{longtblr}[
		caption={Bodovanje odluka igrača u Zatvorenikovoj dilemi \\
			Napomena: Bodovi Igrača 1 su dani prvim brojem u svakom od parova.},
		label=Payoffs,
		entry=none
		]{
			width = \textwidth,
			colspec={|X[1,l]|X[2, l]|X[2, l]|X[2,l]|}, 
			rowhead = 0,
		} %definicija širine tablice, širine stupaca, poravnanje i broja redaka naslova tablice
		\hline 
		\SetCell[c=2, r=2]{c,r}{} & & \SetCell[c=2]{c}{Igrač 2} \\ \hline
		& & Suradnja & Izdaja \\ \hline
		\SetCell[r=2]{r}{Igrač 1} & Suradnja & 3, 3 & 0, 5 \\ \hline
		& Izdaja & 5, 0 & 1, 1 \\ \hline
	\end{longtblr}
	 
	Zbog ove karakteristike Zatvorenikova dilema dobro opisuje mnoge probleme iz stvarnog života i objašnjava zašto je ponekad suradnja s neprijateljem poželjna. Poznati je takav primjer problem prekomjernog naoružavanja i međusobnog nepovjerenja SAD-a i SSSR-a tijekom hladnog rata \cite{1980Axelrod1} Upravo je i taj problem bio jedan od motiva nastanka i proučavanja Zatvorenikove dileme.
	
	Zatvorenikova dilema dobro modelira određena ponašanja nekih životinjskih vrsta u prirodi. Tako je primijećeno ponašanje poznato kao \textit{inspekcija predatora} kod nekih vrsta riba kao što su gupi riba (lat. \textit{Poecilia reticulata}) i koljuška (lat. \textit{Gasterosteus aculeatus}). \cite{TheEvolutionOfCooperation}
	
	Također je primijećena suradnja kod impala koje se međusobno timare kako bi se štitile od krpelja. No, zbog nedostatka informacija o cijeni i nagradi za ovakvo ponašanja teško je ovaj primjer modelirati Zatvorenikovom dilemom. \cite{TheEvolutionOfCooperation}

	\section{Dobra strategija}
	\label{pog:DobraStrategija}
	
		Pitanje koje se prirodno nameće u ponavljajućoj Zatvorenikovoj dilemi je dosta očito: Kako dobro igrati ovu igru? Kojom strategijom pristupiti ovoj igri?

		U svrhu istraživanja optimalnih strategija Robert Axelrod je 1980. organizirao turnir \cite{1980Axelrod1} u koji je pozvao znanstvenike iz raznih područja koji su se bavili Zatvorenikovom dilemom. Sudionici su za turnir izradili strategije igranja Zatvorenikove dileme u obliku računalnog programa. Svaka strategija je igrala Zatvorenikovu dilemu u 200 iteracija sa svakom drugom strategijom, sa samom sobom i s dodatnom strategijom koja je donosila nasumične odluke. Kasnije te godine Axelrod je organizirao još jedan sličan turnir u svrhu provođenja dodatne analize \cite{1980Axelrod2}.
	
		Pobjednik u oba turnira je bila strategija zvana \textit{Tit for Tat}, također poznata i kao \textit{Copycat}. Strategija je vrlo jednostavna -- na prvom potezu uvijek surađuje, a dalje uvijek kopira suparnikov prethodni potez \cite{1980Axelrod1}.
	
		Axelrod je analizom rezultata oba turnira pronašao nekoliko karakteristika koje su bile ključne za uspješnost strategija u oba turnira. Pronađene karakteristike su:
		\begin{itemize}
			\item \textbf{Ljubaznost} (eng. \textit{niceness}) \cite{1980Axelrod1} -- strategija je ljubazna ako nikada neće prva izdati drugog igrača
			\item \textbf{Sklonost opraštanju} (eng. \textit{forgiveness}) \cite{1980Axelrod1} -- sklonost strategije da surađuje nakon što ju je drugi igrač izdao
			\item \textbf{Provokabilnost} (eng. \textit{provocability}) \cite{1980Axelrod2} -- sklonost da strategija izda drugog igrača odmah nakon što ju je drugi igrač izdao
		\end{itemize}
		
		Valja primijetiti da su karakteristike sklonosti opraštanju i provokabilnost zapravo u suprotnosti. No one nisu binarne (ili su prisutne u strategiji ili nisu) neko se pojavljuju u strategijama u nekoj mjeri. Zbog toga nisu međusobno isključive. Također, provokabilnost promatra trenutnu reakciju na izdaju od strane drugog igrača, dok sklonost opraštanju može kroz više poteza gledati vjerojatnost da igrač oprosti izdaju \cite{1980Axelrod2}.
	
		Strategija \textit{Tit for Tat} je bila uspješna jer je bila ljubazna te je imala dobru ravnotežu između sklonosti opraštanju i provokabilnosti. \textit{Tit for Tat} je ljubazna strategija jer počinje sa suradnjom i izdaje samo ako ju je drugi igrač izdao prvi. Strategija oprašta jer će nakon što bude jedom izdana uzvratiti izdajom, ali će nakon toga nastaviti surađivati dok ponovno ne bude izdana -- strategija pamti samo posljednji suparnikov potez. Također, strategija je provokabilna jer će nakon što bude izdana uvijek i odmah uzvratiti izdajom.
		
		Valja zamijetiti jednu vrlo zanimljivu činjenicu. Ako malo razmislimo o strategiji \textit{Tit for Tat}, možemo primijetiti da ta strategija nikada ne može igrati bolje od igrača s kojim igra Zatvorenikovu dilemu. U najboljem slučaju strategija \textit{Tit for Tat} može dobiti jednak broj bodova kao i drugi igrač. Ovo pokazuje da kod ponavljajuće Zatvorenikove dileme nije uvijek nužno biti bolji od drugog igrača, već igrati kontinuirano dobro s različitim strategijama. 
	
		Axelrod je u svojem radu napomenuo važnu stvar, a to je da ne postoji najbolja strategija za igranje ponavljajuće Zatvorenikove dileme. To proizlazi iz jednostavne činjenice da performansa strategije uvelike ovisi o strategijama s kojima ta strategija igra. Dakle, okruženje u kojem se nalazi je od presudne važnosti \cite{1980Axelrod1}.
	
		No kroz detaljnu analizu drugog turnira Axelrod je ustanovio da su navedene karakteristike generalno poželjne i u pravilu donose dobre rezultate. Također, iako \textit{Tit for Tat} nije univerzalno najbolja strategija, pokazuje se da generalno daje odlične rezultate u raznim okruženjima zbog dobro kombiniranih poželjnih karakteristika \cite{1980Axelrod2}.
	
		Axelrod je također napomenuo da je kod kreiranja strategije potrebna analiza na barem 3 dubine \cite{1980Axelrod1}. Prva razina je direktna posljedica trenutne odluke, to jest, koliko bodova igrač dobiva na temelju svoje odluke. Druga razina je uzimanje u obzira da će drugi igrač možda odlučiti kazniti izdaju. Treća razina razmatra da reagiranje na izdaju može prouzrokovati eho efekt međusobnih izdaja koji će dugoročno štetiti i jednom i drugom igraču.

\chapter{Umjetne neuronske mreže}
\label{pog:NeuronskeMreze}
	
	Umjetne neuronske mreže su jedan od mnogih koncepata u strojnom učenju, koje je jedno od najvećih grana umjetne inteligencije. Prvi puta su ih predložili Warren McCullough i Walter Pitts sa Sveučilišta u Chicagu davne 1944. Prva neuronska mreža koja se mogla trenirati je bila Perceptron, a predložio ju je psiholog Frank Rosenblatt sa Sveučilišta Cornell 1957. \cite{MITNeuralNet}
	
	Umjetne neuronske mreže su inspirirane ljudskim mozgom - sastoje se od velikog broja jednostavnih umjetnih neurona koji su gusto povezani. \cite{MITNeuralNet}
	
	Područje koje se bavi umjetnim neuronskim mrežama zove se neuro-računarstvo, koje čini granu računarstva iz skupine mekog-računarstva. Meko računarstvo objedinjuje pristupe čiji je cilj izgraditi tehničke sustave za rješavanje teških problema s čestim šumom i nepouzdanošću u ulaznim podacima. \cite{skriptaNeuronskeMreze} 
	
	Umjetni neuron je najmanja funkcionalna jedinka neuronske mreže i modelira biološki neuron u ljudskom mozgu. Umjetni neuroni imaju ulogu jednostavne procesne jedinice. Svaki umjetni neuron na ulazu prima nekakve numeričke vrijednosti (izlazi drugih neurona ili ulazni podaci), obično označene kao vektor $\vec{x}$. Svaki ulazni podatak u neuron $x_i$ se prvo množe s težinom veze $w_i$ preko koje je došao do trenutnog neurona. Dobiveni umnošci se zbrajaju, te im se dodatno pribraja takozvani pomak (eng. \textit{bias}), obično označavan s $w_0$. Tako nastala suma se obično označava s \text{net} te se može izraziti formulom \ref{net}. Ako se pak vektor ulaznih podataka umjetno proširi s komponentom $x_0$ koja ima fiksnu vrijednost $1$, onda se formula za računanje težinske sume ulaza može još jednostavnije izraziti, kao što je prikazano izrazom \ref{konacanNet}.
	
	\begin{equation}
		\label{net}
		\text{net} = \sum_{i=1}^{n} w_i \cdot x_i + w_0
	\end{equation}
	
	\begin{equation}
		\label{konacanNet}
		\text{net} = \sum_{i=0}^{n} w_i \cdot x_i = \vec{w} \cdot \vec{x}
	\end{equation}
	
	Takva se suma provlači kroz prijenosnu funkciju. Rezultat prijenosne funkcije se postavlja na izlaz umjetnog neurona te se propagira dalje na ulaze drugih neurona ili na izlaz neuronske mreže. Model ovako opisanog neurona prikazan je na slici \ref{modelUmjetnogNeurona}. Postoje razne prijenosne funkcije različitih složenosti koje se mogu koristiti kod umjetnih neurona, a neke od njih su: funkcija identiteta, funkcija skoka, sigmoidna funkcija, tangens hiperbolni, funkcija zglobnica, funkcija propusna zglobnica \cite{skriptaNeuronskeMreze}.
	
	\begin{figure}[htb]
		\centering
		\includegraphics[width=\textwidth]{Extra/modelUmjetnogNeurona.png} 
		\caption{Model umjetnog neuron (preuzeto iz \cite{skriptaNeuronskeMreze})}
		\label{modelUmjetnogNeurona}
	\end{figure}
	
	Umjetni neuroni se povezuju u paralelne strukture različitih arhitektura koje omogućuju paralelnu obradu podataka \cite{skriptaNeuronskeMreze}. Arhitektura umjetne neuronske mreže opisuje kako su povezani umjetni neuroni u mreži i koliko ih ima. Postoje razne arhitekture neuronskih mreža, što jednostavnih, što kompleksnih, a svaka ima svoje prednosti i područja u kojima ima primjenu.
	
	Umjetni neuroni se u umjetnim neuronskim mrežama često organiziraju u slojeve. Tada razlikujemo ulazni sloj, skrivene slojeve i izlazni sloj. Skriveni slojevi i izlazni sloj se sastoje od umjetnih neurona dok ulazni sloj zapravo ne sadrži umjetne neurone kakvi su opisani u odjeljku iznad. Neuroni ulaznog sloja na svoje ulaze samo primaju ulazne podatke neuronske mreže te ih dalje prosljeđuju neuronima prvog skrivenog sloja.
	
	Umjetne neuronske mreže danas imaju vrlo široku primjenu, od obrade slika i signala, prepoznavanja uzoraka, kompresije slika, upravljanja, financija... \cite{skriptaNeuronskeMreze}. Glavne prednosti neuronskih mreža su vrlo dobra sposobnost generalizacije i učenja, čak i uz neprecizne ulazne podatke. Njihova glavna mana je nemogućnost interpretacije njihovog ponašanja, iako su računalni znanstvenici počeli razvijati metode za dedukciju strategija koje neuronske mreže nauče \cite{MITNeuralNet}. Znanje koje neuronske mreže nauče iz podataka je implicitno pohranjeno u način povezivanja neurone i težine veza između njih \cite{skriptaNeuronskeMreze}. Stoga je teško razumjeti zašto je neuronska mreža za neki ulaz dala baš taj izlaz. Također, teško je prepoznati kakvu konkretnu ulogu u sveukupnoj obradi ulaza ima pojedini neuron u mreži.
	
	\section{Elmanova neuronska mreža}
	\label{pog:ElmanovaMreza}
	
		Elmanova neuronska mreža je jednostavna povratna neuronska mreža (\textit{eng. Recurrent Neural Network}). Glavna karakteristika takvih mreža je da imaju neku vrstu povratne veze ili vremenski odgođene veze \cite{ElmanNetSite}.
		
		Elmanova neuronska mreža se u osnovnoj varijanti sastoji od ulaznog sloja, jednog skrivenog sloja i izlaznog sloja. Skriveni sloj ove mreže ima dodatan skriveni kontekst. Kontekst čine neuroni koji služe za pohranu kontekstnih podataka. Dodatno postoje veze iz izlaza skrivenog sloja prema kontekstu i veze iz konteksta prema ulazu u skriveni sloj. Izlaz iz skrivenog sloja se preko tih veza sprema u kontekst. Kod obrade sljedećeg ulaza u neuronsku mrežu skrivenom se sloju na ulaz dodatno stavljaju vrijednosti iz konteksta preko pripadajućih veza te se ukupan ulaz mreže i konteksta dalje obrađuje \cite{Elman}. Jednostavna shema Elmanove mreže prikazana je na slici \ref{ElmanovaMreza}.
		
		\begin{figure}[htb]
			\centering
			\includegraphics[width=0.9\textwidth]{Extra/ElmanovaMreza.png} 
			\caption{Shema Elmanove mreže (preuzeto iz \cite{Elman}) \\
					 Napomena: iscrtkane linije označuju veze koje se mogu trenirati}
			\label{ElmanovaMreza}
		\end{figure}
		
		Ovime se omogućava da Elmanova mreža može pamtiti prošla stanja. Na ovaj način prijašnji ulazi u neuronsku mrežu imaju utjecaj na rezultat obrade nekog budućeg ulaza.
		
		Ovo je korisno svojstvo za model inteligentnog igrača Zatvorenikove dileme, s obzirom na to da je prirodno da prijašnje interakcije s drugim igračem utječu na nove odluke.
	
\chapter{Evolucijsko računanje}
\label{pog:EvolucijskoRacunanje}

	Evolucijsko računanje je grana umjetne inteligencije koja se najčešće bavi rješavanjem optimizacijskih problema. Začeci ove grane sežu još u kasne 50-e godine prošlog stoljeća. Evolucijsko računanje se može podijeliti u tri grane \cite{skriptaEvolucijskoRacunarstvo}: 
	\begin{itemize}
		\item \textit{evolucijske algoritme}
		\item \textit{algoritme rojeva}
		\item \textit{ostale algoritme}
	\end{itemize}
	
	Neki od algoritama iz grane evolucijskih algoritama su evolucijske strategije, evolucijsko programiranje, genetski algoritam i genetsko programiranje \cite{skriptaEvolucijskoRacunarstvo}.
	
	U grani algoritma rojeva nalaze se mravlji algoritmi, algoritam roja čestica, algoritmi pčela i drugi \cite{skriptaEvolucijskoRacunarstvo}.
	
	Neki do značajnih algoritama iz grane ostali algoritmi pripadaju umjetni imunološki algoritmi, algoritam diferencijske evolucije i algoritam harmonijske pretrage \cite{skriptaEvolucijskoRacunarstvo}.
	
	Područje evolucijskog računanja također pripada području metaheuristika. Metaheuristika je skup algoritamskih koncepata koji se koriste za definiranje heurističkih metoda primjenjivih na široki skup problema \cite{skriptaEvolucijskoRacunarstvo}. Heurističke metode su algoritmi koji pronalaze rješenja problema koja su zadovoljavajuće dobra, ali ne nužno optimalna. Heurističke metode obično imaju relativnu nisku računsku složenost \cite{skriptaEvolucijskoRacunarstvo}.

	\section{Optimizacija}
	\label{pog:Optimizacija}
	
		Kao što je ranije navedeno, algoritmi iz područja evolucijskog računanja se često koriste u problemima optimizacije. Optimizaciju možemo definirati kao postupak pronalaženja najboljeg rješenja problema. Uz svako rješenje se pridružuje funkcija dobrote ili funkcija kazne. Ako se rješenjima pridružuje funkcija dobrote, optimizacijski postupak će tražiti rješenje tako da pokuša maksimizirati funkciju dobrote. Ako se pak rješenjima pridružuje funkcija kazne, optimizacijski postupak će pokušati minimizirati funkciju kazne.\cite{skriptaEvolucijskoRacunarstvo}

		Bitno je reći da kada gledamo optimizacijske algoritme iz područja evolucijskog računanja, niti jedan od njih se ne može istaknuti kao generalno najbolji algoritam. Svaki od tih algoritama je dobar u određenim primjenama, dok u drugim primjenama drugi optimizacijski algoritmi daju bolje rezultate. U prosjeku nema značajnih razlika u globalnim performansama kada se gleda prosjek po svim mogućim funkcijama cijene.\cite{skriptaEvolucijskoRacunarstvo}
	
	\section{Genetski algoritam}
	\label{pog:Genetski algoritam}
	
		Genetski algoritam je algoritam iz grane evolucijskih algoritama. Općenito, svi pristupi iz grane evolucijskih algoritama crpe inspiraciju iz Darwinove teorije o postanku vrsta, koja se temelji na pet pretpostavki \cite{skriptaEvolucijskoRacunarstvo}:
		\begin{enumerate}
			\item potomaka uvijek ima više nego je potrebno
			\item veličina populacije je približno stalna u vremenu
			\item hrana je ograničen resurs
			\item ne postoje dvije potpuno identične jedinke kod vrsta koje se seksualno razmnožavaju -- postoje varijacije
			\item većina varijacija se prenosi nasljeđem
		\end{enumerate}
		
		Genetski algoritam je jedan od algoritama koji rješavaju optimizacijske probleme, a koji izravno utjelovljuje navedene postavke. Genetski algoritam zapravo nije jedinstven, već se može implementirati na različite načine. \cite{skriptaEvolucijskoRacunarstvo}
		
		Ideja genetskog algoritma je modeliranje evolucijskog procesa. U algoritmu postoji populacija jedinki, koje zapravo predstavljaju neka od mogućih rješenja problema. Cilj algoritma je kroz selekciju roditelja, stvaranje novih jedinki korištenjem operatora križanja nad roditeljima i korištenje operatora mutiranja nad novim jedinkama stvoriti najbolje ili barem dovoljno dobro rješenje problema. Selekcija roditelja bi trebala ovisiti o nekakvoj metrici uspješnosti - uspješniji roditelji bi generalno trebali imati veće izglede da budu odabrani za križanje. Ta metrika se obično naziva dobrota. Takvim postupkom se očekuje da će se kontinuiranim križanjem uspješnih roditelja i mutiranjem njihove djece stvarati bolja rješenja. Ovo je zapravo svojevrstan ekvivalent prirodnoj selekciji, to jest preživljavanju najboljih.
	
		Varijacije u implementaciji se mogu pojavljivati u načinu mutiranja, križanja, selekcije, ali i magnitudi izmjena u populaciji u jednoj iteraciji algoritma. 
		
		Tako u jednoj krajnosti imamo takozvani \textit{eliminacijski genetski algoritam} u kojem se u jednoj iteraciji samo jedna jedinka zamjenjuje jednim novonastalim djetetom. Novo dijete već u sljedećem koraku može biti roditelj. \cite{skriptaEvolucijskoRacunarstvo}
		
		U drugoj krajnosti imamo \textit{generacijski genetski algoritam}. U njemu se u jednoj iteraciji iz jedne populacije biraju roditelji čija se djeca spremaju u novu populaciju sve dok nova populacije ne dosegne veličinu populacije roditelja. Tada populacija djece zamjenjuje populaciju roditelja. U ovoj varijanti dijete može biti roditelj tek kada populacija djece postane populacija roditelja, to jest u sljedećoj iteraciji. \cite{skriptaEvolucijskoRacunarstvo}
		
		Operator križanja se primjenjuje nad dvije jedinke (roditelji) i iz njih stvara dijete. Može se implementirati na razne načine, ali generalno ovaj operator često vrši kontrakciju nad populacijom. To znači da se primjenom ovog operatora obično gubi raznolikost između jedinki te one u prosjeku postaju sve sličnije. \cite{skriptaEvolucijskoRacunarstvo}
		
		Operator mutacije ima upravo suprotno svojstvo. On vrši nasumične izmjene nad jedinkama i time im vraća raznolikost. Njegova važna uloga je izbaciti populaciju iz lokalnih maksimuma u prostoru rješenja \cite{skriptaEvolucijskoRacunarstvo}.
	
\chapter{Implementacija inteligentnog igrača}
\label{pog:Implementacija}

	Inteligentni igrač Zatvorenikove dileme modeliran je Elmanovom neuronskom mrežom. Mreža se sastoji od ulaznog sloja, jednog skrivenog sloja s kontekstom, još jednog skrivenog sloja i izlaznog sloja. Svi slojevi su potpuno povezani. Veze između izlaza skrivenog sloja i konteksta su jedan-na-jedan, to jest izlaz jednog neurona se preslikava u "kopiju" tog neurona u kontekstu. To implicitno znači da skriveni kontekst ima jednak broj neurona kao i sam skriveni sloj. Veze između konteksta i ulaza u neurone skrivenog sloja su svaki-sa-svakim, isto kao i između ostalih slojeva u mreži. Svi neuroni u korištenoj neuronskoj mreži koriste sigmoidnu prijenosnu funkciju.
	
	Korištena mreža je arhitekture 1 x 4 x 2 x 1. Ulaz u mrežu je brojčana vrijednost odluke suparničkog igrača iz prijašnje runde. Ako prijašnje runde još nije bilo, tada se na ulaz dovodi 0. Odluka o suradnji je brojčano kodirana vrijednošću 1, a odluka o izdaju vrijednošću -1. Izlaz mreže je brojčana vrijednost između 0 i 1 koja se interpretira kao potez inteligentnog igrača u ovoj rundi Zatvorenikove dileme. Vrijednost se interpretira na sljedeći način:
	\begin{itemize}
		\item ako je vrijednost veća ili jednaka 0.5, interpretiraj izlaz mreže kao suradnju
		\item ako je vrijednost manja od 0.5, interpretiraj izlaz mreže kao izdaju
	\end{itemize}

	\section{Učenje inteligentnog igrača}
	\label{pog:Ucenje}
	
	S obzirom na karakteristike Zatvorenikove dileme i dinamiku okruženja u kojem inteligentni igrač mora donositi odluke, često korišteno nadzirano učenje neuronske mreže algoritmom propagacije unazad ovdje nije primjenjivo.
	
	Ako bismo koristili algoritam propagacije unazad, morali bismo za svaki ulaz definirati očekivani (najbolji) izlaz, to jest optimalnu odluku u toj situaciji. S obzirom na to da u ovom problemu postoje samo 3 moguća ulaza u mrežu (0 ako se radi o prvoj rundi, 1 ako je u prijašnjoj rundi suparnički igrač surađivao i -1 ako je izdao ovoga igrača), skup za učenje bi bio premalen. Također, problem u tom pristupu je to što bismo time inteligentnom igraču zapravo predstavljali problem Zatvorenikove dileme sa samo jednom iteracijom, a taj problem ima potpuno različit pristup u odnosu na ponavljajuću Zatvorenikovu dilemu, kao što je prije raspravljeno. Još jedan problem je u tome što je zapravo teško odrediti što je najbolji potez koji igrač može odigrati u nekom okruženju. 
	
	Zbog toga je za ovaj problem odlučeno koristiti jednu drugu tehniku, a to je učenje neuronske mreže genetskim algoritmom. Ideja ove tehnike je koristiti genetski algoritam kao algoritam optimizacije nad neuronskim mrežama. Cilj optimizacije je pronaći težine veza između neurona (i pomake svakog neurona) koje će davati najbolje (ili barem dovoljno dobre) performanse neuronske mreže u igri Zatvorenikove dileme. Ova tehnika nam omogućuje da težine veza između neurona prilagođavamo nakon što je inteligentni igrač odigrao nekoliko igra, kada imamo bolju predodžbu o kvaliteti njegovog igranja.
	
	\subsection{Parametri genetskog algoritma}
	\label{pog:ParametriGenetskogAlg}
	
		Za genetski algoritam nad neuronskom mrežom je samo potrebno definirati kriterij i postupak nagrađivanja te rangiranja neuronskih mreža, način selekcije roditelja, operatore križanja i mutacije s njihovim parametrima, magnitudu izmjena u populaciji, veličinu populacije i kriterij za završetak algoritma.
		
		Kao kriterij nagrađivanja i rangiranja neuronskih mreža iz populacije koriste se bodovi dobiveni igranjem Zatvorenikove dileme. Svaka mreža iz populacije igra zadani broj rundi Zatvorenikove dileme sa svakom drugom neuronskom mrežom i sa samom sobom. Dodatno, svaka mreža igra Zatvorenikovu dilemu 4 puta protiv 11 unaprijed pripremljenih strategija za igranje Zatvorenikove dileme. Jedna od tih strategija, nazvana \textit{Detective}, preuzeta je s interaktivne stranice \textit{The Evolution of Trust} koja prezentira zanimljive aspekte Zatvorenikove dileme \cite{NickyCase}. Ostalih 10 strategija preuzeto iz prvog Axelrodovog turnira. Strategije su implementirane po opisima dostupnima u Axelrodovom radu u kojem je objavio rezultate prvog turnira \cite{1980Axelrod1}. Također, za referencu je korišten i izvorni kod implementacije nekih od strategija u programskom jeziku Python pronađen na internetu \cite{AxelrodStratImplPython}. Implementirane strategije iz Axelrodovog turnira su: 
		\begin{itemize}
			\item \textit{Tit for Tat}
			\item \textit{Nydegger}
			\item \textit{Grofman}
			\item \textit{Shubik}
			\item \textit{Friedman}
			\item \textit{Davis}
			\item \textit{Downing}
			\item \textit{Joss}
			\item \textit{Tullock}
			\item \textit{Random}
		\end{itemize}
		
		Valja napomenuti da nije pronađena službena dokumentacija o točnoj implementaciji navedenih strategija. Dodatno, kod testiranja implementacija nisu dobiveni potpuno identični bodovi kod međusobnog igranja Zatvorenikove dileme između strategija kao kod objavljenog Axelrodovog rada. Stoga nema garancije da se sve implementirane strategije ponašaju potpuno identično kao što su se ponašale strategije u Axelrodovom turniru.
		
		Broj rundi koje će mreže odigrati u jednoj igri Zatvorenikove dileme može se podešavati u programskom rješenju. Dobiveni bodovi kod međusobnog igranja između mreža se zbrajaju, dok se kod igranja mreže protiv strategije zbraja prosjek ostvarenih bodova protiv te strategije. Dobivena suma predstavlja takozvanu dobrotu neuronske mreže. Ti bodovi se računaju svaki puta nakon stvaranja nove generacije neuronskih mreža. Ovaj način nagrađivanja savršeno odgovara za problem ponavljajuće Zatvorenikove dileme jer ovime nije nužno da neuronska mreža mora pobjeđivati druge neuronske mreže u direktnom okršaju, već je bitno da kontinuirano može dobivati dosta bodova protiv neuronskih mreža s raznim strategijama.
		
		Za selekciju roditelja je korištena proporcionalan selekcija - vjerojatnost da će neuronska mreža biti odabrana za roditelja je proporcionalna njezinim relativnim bodovima u odnosu na druge neuronske mreže.
		
		Kod operatora križanja se za određivanje parametara\footnote{Za parametre neuronske mreže podrazumijevaju se težine veza između neurona i pomaci (eng. \textit{biases})} djeteta nasumično biraju ekvivalentni parametri jednog od roditelja. Odabir roditelja od kojeg će se naslijediti konkretan parametar se ponovno vrši proporcionalnom selekcijom. Dakle, za svaki parametar vrijedi da je vjerojatnost da će on biti naslijeđen od nekog roditelja je proporcionalna relativnoj dobroti tog roditelja u odnosu na drugog roditelja.
		
		Operator mutacije koristi slučajne brojeve iz Gaussove normalne razdiobe s očekivanom vrijednosti 0 i podesivom standardnom devijacijom. Nakon stvaranja novog djeteta, svaki parametar ima vjerojatnost da će nad njim biti izvršen operator mutacije. Mutacija funkcionira tako da se generira slučajan broj te se dobiveni broj pribraja vrijednosti parametra. Ovime se dobivaju mutacije koje su uglavnom malog intenziteta, no mogu biti i velikog. Tako preko jedne mutacije dobivamo kombinaciju češćih malih mutacija i rjeđih velikih mutacija. Vjerojatnost pojavljivanja mutacije i standardnu devijaciju korištenu kod generiranja slučajnog broja moguće je podešavati u programskom rješenju.
		
		Korišten je \textit{generacijski genetski algoritam}. Dakle, u jednoj iteraciji se cijela populacija jedinki zamjenjuje. Iznimka je jedino da se najbolja mreža iz prošle generacije direktno kopira u novu generaciju bez izmjena. Time se nastoji očuvati svojstvo elitizma \footnote{Elitizam je svojstvo algoritma da ne može izgubi najbolje pronađeno rješenje \cite{skriptaEvolucijskoRacunarstvo}}. 
		
		Kriterij zaustavljanja genetskog algoritma je isključivo dosezanje limita za broj generiranih generacija koji se može podesiti u programskom rješenju. Također, u programskom rješenju se može podesiti veličina populacije neuronskih mreža za genetski algoritam.
	
\chapter{Definiranje pokusa}
\label{pog:Pokus}

	Pokus je zamišljen tako da se 20 puta pokrene treniranje neuronskim mreža. Na kraju svakog treniranja se izvlači najbolja neuronska mreža iz zadnje generacije te se s njom igra Zatvorenikova dilema s ciljem da se utvrdi postojanje određenih svojstava u strategiji igranja te neuronske mreže. Svojstva koja će se ispitivati su:
	\begin{itemize}
		\item Ljubaznost (eng. \textit{niceness})
		\item sklonost opraštanju (eng. \textit{forgiveness})
		\item provokabilnost (eng. \textit{provocability})
	\end{itemize}
	
	Navedena svojstva su opisana ranije u poglavlju \ref{pog:ZatvorenikovaDilema}. Promatrat će se učestalost pojavljivanja i metrika pojedinog svojstva u strategijama najboljih igrača. Iz toga će se pokušati izvesti zaključak o tome jesu li i koliko navedena svojstva robusna i poželjna u generalnoj Zatvorenikovoj dilemi neovisnoj o drugim igračima.
	
	Svojstva će se ispitivati i kvantificirati tako da se protiv svake izabrane neuronske mreže igra Zatvorenikova dilema od 16 rudni nekoliko puta. 
	
	Igrač ispitivač protiv inteligentnog igrača prvo igra Zatvorenikovu dilemu tako da uvijek igra suradnju protiv inteligentnog igrača. Ako inteligentni igrač barem jednom odigra izdaju, smatra se da nije ljubazan, a u suprotnom da jest. 
	
	U drugoj igri prvi potez igrača ispitivača je suradnja. Zatim ispitivač igra izdaju dok god drugi igrač igra suradnju. Kada inteligentni igrač odigra izdaju, ispitivač igra suradnju dok god se inteligentni igrač ne "smiri" i ponovno igra suradnju. Nakon toga ispitivač ponovno igra izdaju i ponavlja postupak dok igra traje. Omjer broja ispitivačevih izdaja do reakcije inteligentnog igrača i broj reakcija inteligentnog igrača će biti metrika opraštanja. Na primjer, omjer 15/0 bi značio da je inteligentni igrač cijelu igru surađivao i nikada nije reagirao na 15 izdaja ispitivača. Takav inteligentni igrač bi se smatrao maksimalno opraštajući. Omjer 2/14 bi predstavljao igru u kojoj je nakon prve izdaje ispitivača inteligentni igrač odlučio igrati izdaju do kraja igre. Taj igrač bi bio minimalno opraštajući.
	
	U trećoj igri prvi potez igrača ispitivača je ponovno suradnja. Zatim ispitivač igra jednu izdaju i zatim surađuje dok god inteligentni igrač igra izdaju protiv njega. Nakon što inteligentni igrač prestane igrati izdaju ispitivač ponavlja izdaju i ponavlja postupak. Kao metrika provokabilnosti će se uzimati omjer izdaja ispitivača i trenutnih reakcija inteligentnog igrača na izdaju, neovisno koliko izdaja bilo u reakciji. Tako bi na primjer omjer 5/5 predstavljao inteligentnog igrača koji je nakon svake od 5 ispitivačevih izdaja odmah uzvratio s barem jednom izdajom. Takav igrač bi se smatrao maksimalno provokabilnim. Omjer 8/0 bi predstavljao igru u kojoj je ispitivač 8 puta izdao inteligentnog igrača, a on nije niti jednom uzvratio izdajom u slijećem potezu. Taj igrač se smatra minimalno provokabilnim.
	
	Bitan komentar je da kod inteligentnih igrača koji nisu ljubazni metrike za opraštanje i provokabilnost nisu toliko relevantne i smislene. To je zbog činjenice da kada neljubazan igrač igra izdaju to ne mora biti nužno reakcija na izdaju drugog igrača, već ta izdaja može biti odigrana na vlastitu inicijativu. Unatoč tome, metrike za opraštanje i provokabilnost će biti priložene i za inteligentne igrače koji nisu ljubazni.
	
	Kod treniranja neuronskih mreža korištene su sljedeće postavke genetskog algoritma:
	\begin{itemize}
		\item vjerojatnost mutacije: 0.05
		\item magnituda mutacije (standardna devijacija kod generiranja slučajnog broja): 0.5
		\item veličina generacije: 50
		\item limit broja generiranih generacija: 30
		\item broj rundi u jednoj igri Zatvorenikove dileme: 50
	\end{itemize}

% \Blindtext


%-------------------------------------------------------------------------------
\chapter{Rezultati i rasprava}
\label{pog:rezultati_i_rasprava}

	\begin{longtblr}[
		caption={Rezultati pokusa},
		label=Results2,
		entry=none
		]{
			width = \textwidth,
			colspec={|X[0.5,l]|X[0.6, l]|X[0.6, l]|X[0.8,l]|X[1,l]|}, 
			rowhead = 0,
		} %definicija širine tablice, širine stupaca, poravnanje i broja redaka naslova tablice
		\hline 
		\textbf{Redni\\broj\\pokusa} & \textbf{Ljubaznost} & \textbf{Opraštanje} & \textbf{Provokabilnost} & \textbf{Komentar} \\ \hline
		\textbf{1} & da & 10/5 & 5/5 & sličan strategiji \textit{Tit for Tat}, blaži \\ \hline
		\textbf{2} & da & 10/5 & 5/5 & sličan strategiji \textit{Tit for Tat}, blaži \\ \hline
		\textbf{3} & da & 8/8 & 5/5 & jako sličan strategiji \textit{Tit for Tat} \\ \hline
		\textbf{4} & da & 9/6 & 8/0 & sličan strategiji \textit{Tit for Tat}, blaži; jednom izdao sa odgodom (istovremeno kao i ispitivač) \\ \hline
		\textbf{5} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{6} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{7} & da & 10/5 & 6/3 & kao \textbf{1}, ali još blaži \\ \hline
		\textbf{8} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
		\textbf{9} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{10} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
		
		\textbf{11} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{12} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{13} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
		\textbf{14} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{15} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
		\textbf{16} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{17} & ne & 2/14 & 1/1 & nikada ne surađuje \\ \hline
		\textbf{18} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
		\textbf{19} & da & 12/4 & 6/3 & jako blagi, s vremenom manje oprašta \\ \hline
		\textbf{20} & da & 8/8 & 5/5 & \textit{Tit for Tat} \\ \hline
	\end{longtblr}
	
	12/20 ispitanih inteligentnih igrača je bilo ljubazno. Od toga je 6 njih igralo identično kao strategija \textit{Tit for Tat}. 5 inteligentnih ljubaznih igrača je bilo dosta slično strategiji \textit{Tit for Tat}, ali su bili skloniji opraštanju. Inteligentni igrač pod brojem \textbf{19} je bio zanimljiv jer je bio jako blag prema ispitivaču. No, u malo detaljnijem ispitivanju vidjelo da se da taj igrač s vremenom sve više sliči na strategiju \textit{Tit for Tat} kako ga se više izdaje.
	
	Zanimljivo je da su svi neljubazni igrači bili potpuno identični - svi su stalno igrali izdaju neovisno o drugom igraču.

	\section{Rasprava}
	
		Iako je kod ljubaznih igrača bilo dosta sličnosti, ipak su postojale razlike u ponašanju kod nekih. Postojala je varijanta igrača koja je bila jako oprostiva i slabo provokabilna, ali je znala s vremenom postajati stroža. Najstroža varijanta inteligentnog igrača je bila ona identična strategiji \textit{Tit for Tat}. Zanimljivo je da niti jedan ljubazan igrač nije bio potpuno naivan tako da je stalno igrao suradnju neovisno o drugom igraču.
		
		Kod neljubaznih igrača nažalost nije bilo nikakve raznolikosti u ponašanju. Svi su igrali najjednostavniju strategiju stalne izdaje neovisno o potezima drugog igrača. Šteta je što kroz treniranje inteligentnog igrača nije nastao niti jedan neljubazan igrač koji bi imao neku složeniju strategiju kojom bi pokušao iskoristiti drugog igrača. Možda bi složeniji model inteligentnog igrača uspio naučiti složeniju neljubaznu strategiju igranja ponavljajuće Zatvorenikove dileme.
		
		
		% Možda bi igrač sa neuronskom mrežom malo složenije arhitekture i sa više ulaznih parametara uspio naučiti složeniju neljubaznu strategiju igranja zatvorenikove dileme.

% \Blindtext


%--- ZAKLJUČAK / CONCLUSION ----------------------------------------------------
\chapter{Zaključak}
\label{pog:zakljucak}

	Ovakvi rezultati eksperimenta su uglavnom očekivani, ali ne i u potpunosti zadovoljavajući. 
	
	U ovom jednostavnom eksperimentu strategija \textit{Tit for Tat} se pojavila čak 6 puta, a preostalih 6 ljubaznih taktika je uglavnom imalo dosta sličnosti s tom strategijom. Zbog toga bismo mogli zaključiti da je ta strategija dosta robusna i na neki način prirodan pristup problemu ponavljajuće Zatvorenikove dileme.
	
	No, ne treba zanemariti činjenicu da se u postupku učenja inteligentnog igrača čak 8 buta istrenirao igrač koji je nikada nije surađivao. To se može objasniti činjenicom da najbolja strategija igranja ponavljajuće Zatvorenikove dileme ovisi o okruženju u kojem se Zatvorenikova dilema igra. S obzirom na to da je inicijalno okruženje kod treniranja inteligentnog igrača bilo nasumično, vjerojatno je puno igrača iz populacije za treniranje prvotno cijelo vrijeme igralo izdaju. Ako je takvih igrača bilo dovoljno, vjerojatno je bilo nemoguće razviti neko drugačije ponašanje koje bi se moglo istaknuti u takvom okruženju. No, ipak činjenica da je 8 od 20 igrača razvila ovakvo nekooperativno ponašanje ukazuje da je pristup stvaranja inteligentnog igrača možda mogao biti i bolji. Možda bi model inteligentnog igrača s neuronskom mrežom složenije arhitekture i s više ulaznih podataka u postupku treniranja rjeđe rezultirao igračem koji nikada ne surađuje. Bilo bi zanimljivo vidjeti ako bi složeniji model ponekada naučio neljubaznu strategiju koja na pametan način pokušava iskoristiti druge igrače.

% \blindtext


%--- LITERATURA / REFERENCES ---------------------------------------------------

% Literatura se automatski generira iz zadane .bib datoteke / References are automatically generated from the supplied .bib file
% Upiši ime BibTeX datoteke bez .bib nastavka / Enter the name of the BibTeX file without .bib extension
\bibliography{literatura}



%--- SAŽETAK / ABSTRACT --------------------------------------------------------

% Sažetak na hrvatskom
\begin{sazetak}
	
	Zatvorenikova dilema je poznati problem iz područja teorije igara. U jezgri dileme je sukob između racionalnog razmišljanja maksimiziranja vlastite dobiti dvaju igrača koje ih dovodi do sub-optimalne pozicija te suradnje koja je korisna za oba igrača. Ovaj rad se bavi problemom izrade inteligentnog igrača koji će moći igrati ponavljajući problem Zatvorenikove dileme. Za modeliranje inteligentnog igrača korištena je Elmanova neuronska mreža. Mreža je trenirana generacijskim genetskim algoritmom. Pokusom je pokušano utvrditi učestalost pojedinih karakteristika strategije igranja inteligentnog igrača. Time se želi utvrditi robusnost strategija igranja Zatvorenikove dileme koje posjeduju tražene karakteristike. Karakteristike koje se promatraju su: ljubaznost, sklonost opraštanju i provokabilnost.

  % \blindtext
\end{sazetak}

\begin{kljucnerijeci}
	Zatvorenikova dilema, umjetna inteligencija, umjetne neuronske mreže, inteligentni igrač, Elmanova neuronska mreža
\end{kljucnerijeci}


% Abstract in English
\begin{abstract}
	
	Prisoner's Dilemma is famous problem in game theory. The core of the Dilemma is the conflict between rational thinking of maximizing personal gain that brings two players in sub-optimal position and mutual cooperation that brings benefits for both players. This thesis has goal to create intelligent player for iterated Prisoner's Dilemma. For modelling an intelligent player was used Elman's neural network. The network was trained with generational genetic algorithm. Experiment was used to determine frequency of specific characteristics in the strategies used by the intelligent player. Goal of the experiment is to show how robust strategies that have specified characteristics are. Characteristics that were observed are: niceness, forgiveness and provocability.
	
  % \blindtext 
\end{abstract}

\begin{keywords}
  Prisoner's dilemma, Artificial intelligence, Artificial neural networks, Intelligent player, Elman's neural network
\end{keywords}


%--- PRIVITCI / APPENDIX -------------------------------------------------------

% Sva poglavlja koja slijede će biti označena slovom i riječi privitak / All following chapters will be denoted with an appendix and a letter
\backmatter

\chapter{Programski kod}

	U sklopu ovog završnog rada izrađena je jednostavna aplikacija u programskom jeziku \textit{Java}. Aplikacija omogućuje treniranje Elmanove neuronske mreže genetskim algoritmom i igranje Zatvorenikove dileme.
	
	Aplikacija u početnom prozoru prikazuje 4 gumba pomoći kojih nudi sljedeće mogućnosti:
	\begin{itemize}
		\item Treniranje neuronske mreže
		\item Igranje Zatvorenikove dileme
		\item Učitavanje postojeće neuronske mreže
		\item Prikaz kratkog opisa aplikacije u odvojenom prozoru.
	\end{itemize}
	
	Kod izbora treniranja neuronske mreže prikazuje se prozor u kojem se mogu podesiti sljedeći parametri genetskog algoritma:
	\begin{itemize}
		\item Vjerojatnost mutacije
		\item Magnituda mutacije (standardna devijacija Gaussove normalne razdiobe)
		\item Veličina populacije
		\item Najveći broj generiranih generacija prije završavanja algoritma
		\item Broj iteracija u jednoj igri Zatvorenikove dileme prilikom određivanja dobrote svake mreže
	\end{itemize}
	
	Nakon podešavanja parametara pokreće se genetski algoritam. Program je podešen tako da sprema najbolju, medijalnu i najlošiju neuronsku mrežu svake pete generacije u direktorij \textit{src/main/resources} Maven projekta. Na dnu prozora je prikazan teoretski najveća moguća dobrota koju neka mreža može ostvariti. Dodatno, za svaku se generaciju ispisuju sljedeći podaci:
	\begin{itemize}
		\item Dobrota najbolje mreže iz te generacije
		\item Dobrota medijalne mreže iz te generacije
		\item Dobrota najlošije mreže iz te generacije
	\end{itemize}
	
	Genetski algoritam se može prisilno završiti ranije nego je predviđeno pritiskom na gumb \textit{Stop}.
	
	Po završetku genetskog algoritma omogućeno je da korisnik igra Zatvorenikovu dilemu protiv najbolje mreže iz posljednje generacije genetskog algoritma. Igra se sastoji od 16 rundi Zatvorenikove dileme. Prozor prikazuje ostvarene bodove svakog igrača u svakoj rundi te ukupno ostvarene bodove. Neuronska mreža uvijek igra kao \textit{Player 2}, dok je korisnik \textit{Player 1}.
	
	Kod izbora igranja Zatvorenikove dileme priprema se Zatvorenikova dilema za dva korisnička igrača. Prvo se prikazuje prozor koji prikazuje kontrole za oba igrača. kontrole za svakog igrača su prikazane u tablici \ref{kontrole} i stalno su iste.
	
	\begin{longtblr}[
		caption={Kontrole pojedinog igrača},
		label=kontrole,
		entry=none
		]{
			width = \textwidth,
			colspec={|X[1,l]|X[2, l]|X[2, l]|X[2,l]|}, 
			rowhead = 0,
		} %definicija širine tablice, širine stupaca, poravnanje i broja redaka naslova tablice
		\hline 
		 & Suradnja & Izdaja \\ \hline
		\textit{Player 1} & W & S \\ \hline
		\textit{Player 2} & P & L \\ \hline
	\end{longtblr}
	
	Nakon toga se prikazuje prozor koji prikazuje osvojene bodove svakog igrača na identičan način kao i prilikom igranja Zatvorenikove dileme s inteligentnim igračem nakon provođenja genetskog algoritma. Igra se ponovno sastoji od 16 rundi.
	
	Kod odabira učitavanja neuronske mreže iz datoteke otvara se prozor za odabir datoteke. Nakon što korisnik odabere datoteku aplikacija će pokušati učitati neuronski mrežu iz datoteke. Po završetku uspješnog učitavanja mreže pokreće se igra identično kao i nakon treniranja neuronske mreže genetičkim algoritmom.
	
	Za programsko rješenje korištena je \textit{Java 17}. Programski kod je organiziran kao Maven projekt. Dodatno je korištena vanjska Maven biblioteka \textit{nd4j-native-platform}. Korištena biblioteka nudi razne optimizirane operacije vezane uz linearnu algebru. Ono što je bilo bitno za ovaj projekt je bilo mogućnost optimiziranog matričnog množenja koje se koristi kod izračunavanja izlaza neuronske mreže. Za izradu grafičkog korisničkog sučelja (eng. \textit{GUI}) korištena je biblioteka \textit{Swing} koja je dio standardne biblioteke programskog jezika \textit{Java}.
	
	Izvorni kod programskog rješenja i sam završni rad dostupni su na javnom Git repozitoriju na \href{https://github.com/PetarBelosevic/Prisoner-s-Dilemma-AI.git}{poveznici}. Za korištenje programskog rješenja potrebno je preuzeti Git repozitorij, prevesti preuzeti Maven projekt (u naredbenom retku pomoću naredbe \textit{mvn compile}) i pokrenuti izvođenje iz razreda \textit{application.GUIApp} (u naredbenom retku pomoću naredbe \textit{mvn exec:java -Dexec.mainClass="application.GUIApp"}).
	
	U programskom kodu dostupno je nekoliko razreda koji nude slične funkcionalnosti kao i aplikacija s grafičkim korisničkim sučeljem. Korišteni su za isprobavanje funkcionalnosti prije izrade grafičkog korisničkog sučelja.
	
	Prvi takav razred je \textit{game.application.ConsoleApp} koji omogućava igranje Zatvorenikove dileme koju igraju dva korisnika preko konzole. Kod oba igrača unos teksta "c" ili "C" se interpretira kao suradnja, a sve ostalo kao izdaja.
	
	Sljedeći takav razred je \textit{evolution.training.ConsoleTestingApp}. Razred omogućuje učitavanje neuronske mreže iz datoteke te igranje Zatvorenikove dileme protiv te mreže preko konzole.
	
	Posljednji takav razred je \textit{evolution.training.ConsoleTrainingApp}. Razred omogućava provođenje genetičkog algoritma kao i kod aplikacije s grafičkim sučeljem. Postupak u konzoli ispisuje dobrote najbolje, medijalne i najlošije neuronske mreže svake 5. generacije te iste neuronske mreže sprema u datoteke na disku.

% \Blindtext

\end{document}
